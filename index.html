<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>kploy by mhausenblas</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-light.css">
    <meta name="viewport" content="width=device-width">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <a href="http://kubernetes.io"><img src="https://raw.githubusercontent.com/kubernetes/kubernetes/master/logo.png" width="100px" alt="Kubernetes logo" style="margin-bottom: 100px"></a>
        <h1>kploy</h1>
        <p>An opinionated Kubernetes deployment system for appops</p>
        <div><a href="https://github.com/kubernauts/kploy">GitHub</a></div>
      </header>
      <section>
        <h2>Why bother?</h2>
        <p>Are you an <a href="https://medium.com/@mhausenblas/what-is-appops-why-do-i-care-what-i-do-about-it-b83a28b0eabc">appops</a>? 
        Do you want to run microservices-style Kubernetes applications in a simple and convinient way? Is the <code>kubectl</code> interface too low-level and feels sorta cumbersome to use?
        <em>If you found yourself answering one of the above questions with a Yes, then read on.</em></p>
        <p>The basic idea of kploy is to deploy and manage an app based on a collection of manifest files, such as Kubernetes service or replication controller manifests.
        With kploy you simply set up your app deployment descriptor and use convention over configuration in order to manage your app across the entire lifecycle.</p>
        <ul>
          <li><a href="#init">Create</a> app from scratch or from archive: <code>kploy init</code></li>
          <li><a href="#run">Launch</a> app: <code>kploy dryrun</code> and <code>kploy run</code></li>
          <li><a href="#manage">Monitor</a> app behaviour: <code>kploy list</code> and <code>kploy stats</code></li>
          <li><a href="#scale">Scale</a> app: <code>kploy scale</code></li>
          <li><a href="#destroy">Destroy</a> app and release resources: <code>kploy destroy</code></li>
          <li><a href="#export">Export</a> app: <code>kploy export</code></li>
        </ul>
        <p>For a quick overview, check out the <a href="https://github.com/kubernauts/kploy/blob/master/examples.md">walkthrough example</a> and have a look at the following screen cast:</p> 
        <div>
          <iframe width="420" height="315" src="https://www.youtube.com/embed/TJpucj4v4iE" frameborder="0" allowfullscreen></iframe>
        </div>
      </section>
      <section>
        <h2>Install</h2>
        <p>You'll need Python 2.6 or above and then you can install kploy simply like so:</p>
<pre><code>pip install kploy</code></pre>
        <p>Note that kploy assumes that you have access to a Kubernetes cluster. It does not help you in setting one up.</p>
      </section>
      <section>
        <h2 id="init">Prepare your deployment</h2>
        <p>Use the <code>init</code> command to create the required scaffolding:</p>
<pre><code>$ ./kploy init
================================================================================

OK, I've set up the Kployfile deployment file and created necessary directories.
Now edit the deployment file and copy manifests into the respective directories.

$ ls -al
drwxr-xr-x  10 mhausenblas  staff   748B 13 Dec 17:41 .
drwxr-xr-x  23 mhausenblas  staff   816B  5 Dec 07:44 ..
-rw-r--r--   1 mhausenblas  staff    85B 13 Dec 17:41 Kployfile
drwxr-xr-x   2 mhausenblas  staff    68B 13 Dec 17:41 rcs
drwxr-xr-x   2 mhausenblas  staff    68B 13 Dec 17:41 services

$ cat Kployfile
apiserver: http://localhost:8080
author: CHANGE_ME
cache_remotes: False
name: CHANGE_ME
namespace: default
source: CHANGE_ME
</code></pre>
        <p>In the above Kployfile, change at least the <code>apiserver</code> field to point it to the API Server of your Kubernetes cluster.</p>
        <p>Alternatively, you can create an app from an existing archive. By convention the ZIP archive must be called
        <code>app.kploy</code> in order to be recognized when you execute the <code>init</code> command:
        </p>
<pre><code>$ ls -al
drwxr-xr-x  8 mhausenblas  staff   714B 22 Dec 13:28 .
drwxr-xr-x  6 mhausenblas  staff   238B 21 Dec 13:58 ..
-rw-r--r--  1 mhausenblas  staff   1.0K 22 Dec 12:10 app.kploy

$ ./kploy init -v
2015-12-22T01:40:49 Detected archive /Users/mhausenblas/Documents/repos/kubernauts/kploy/app.kploy
================================================================================

OK, I've set up the deployment from archive.
You can now validate it with `kploy dryrun`

$ ls -al
drwxr-xr-x  8 mhausenblas  staff   714B 22 Dec 13:40 .
drwxr-xr-x  6 mhausenblas  staff   238B 21 Dec 13:58 ..
-rw-r--r--  1 mhausenblas  staff   174B 22 Dec 13:40 Kployfile
-rw-r--r--  1 mhausenblas  staff   1.0K 22 Dec 12:10 app.kploy
drwxr-xr-x  2 mhausenblas  staff   102B 22 Dec 13:40 rcs
drwxr-xr-x  2 mhausenblas  staff   102B 22 Dec 13:40 services
</code></pre>
        
      </section>
      <section>
        <h2 id="run">Deploy your app</h2>
        <p>To validate your deployment use the <code>dryrun</code> command:</p>
<pre><code>$ ./kploy dryrun
Validating application `myns/simple_app` ...

  CHECK: Is the Kubernetes cluster up &amp; running and accessible via `http://52.10.201.177/service/kubernetes`?
  \o/ ... I found 1 node(s) to deploy your wonderful app onto.

  CHECK: Are there RC and service manifests available around here?
         I found 1 RC manifest(s) in /Users/mhausenblas/Documents/repos/mhausenblas/kploy/rcs
         I found 1 service manifest(s) in /Users/mhausenblas/Documents/repos/mhausenblas/kploy/services
  \o/ ... I found both RC and service manifests to deploy your wonderful app!
================================================================================

OK, we're looking good! You're ready to deploy your app with `kploy run` now :)
</code></pre>
        <p>Looks fine, so to actually deploy your app, do:</p>
<pre><code>$ ./kploy run
2015-12-14T10:34:45 From /Users/mhausenblas/Documents/repos/mhausenblas/kploy/services/webserver-svc.yaml I created the service "webserver-svc" at /api/v1/namespaces/default/services/webserver-svc
2015-12-14T10:34:46 From /Users/mhausenblas/Documents/repos/mhausenblas/kploy/rcs/nginx-webserver-rc.yaml I created the RC "webserver-rc" at /api/v1/namespaces/default/replicationcontrollers/webserver-rc
================================================================================

OK, I've deployed `simple_app`.
Use `kploy list` to check how it's doing.
</code></pre>
        <p>There you go, you just deployed an app on Kubernetes, with a single command. Well done!</p>
        <p>You can also use URLs rather than manifests themselves: kploy will download these so called
        remotes and via <code>cache_remotes</code> in the Kployfile you can control when this should take place.
        The `cache_remotes` flag only applies to the `run` command, that is, all other commands such as `dryrun` or `list` will always work with the cached manifests.
        </p>
        <p>One use case for remotes is to benefit from <a href="https://github.com/helm/charts">charts</a> (of the <a href="http://helm.sh/">helm</a> project), like so:</p>
        
<pre><code>$ echo https://raw.githubusercontent.com/helm/charts/master/elasticsearch/manifests/elasticsearch-rc.yaml > rcs/elasticsearch-rc.yaml.url</code></pre>
      <p>Note that when <code>kploy run</code> is executed, the resources are marked with the additional label <code>guard=pyk</code>.
      This label allows us to identify resources (RCs and services) that are managed by kploy. Do not manually remove them.
      </p>
      <p>
        If you need to pass confidential data such as passwords or API keys to one of your services, just let kploy handle it
        automagically via its env mechanism: read more about it in the <a href="https://github.com/kubernauts/kploy/blob/master/env.md#secrets">Secrets</a>
        section of the env doc.
      </p>
      </section>
      <section>
        <h2 id="manage">Manage your app</h2>
        <p>To see how your app is doing, use the <code>list</code> command. All services and RCs of the app will be listed, along with their status
        (<code>online</code> means it&#8217;s deployed and running) and their resource URL:</p>
<pre><code>$ ./kploy list
Resources of app `myns/simple_app`:
NAME           MANIFEST                     TYPE     STATUS    URL
webserver-svc  services/webserver-svc.yaml  service  online   http://ma.dcos.ca1.mesosphere.com/service/kubernetes/api/v1/namespaces/default/services/webserver-svc
webserver-rc   rcs/nginx-webserver-rc.yaml  RC       online   http://ma.dcos.ca1.mesosphere.com/service/kubernetes/api/v1/namespaces/default/replicationcontrollers/webserver-rc
</code></pre>
        <p>Hint: if you want to learn about any of the supported commands, simply add an <code>explain</code> before the command, for example:</p>
<pre><code>$ ./kploy explain list
list:
    Lists apps and their status.
</code></pre>
        <p>If you want to learn more about how your app uses the cluster, use the <code>stats</code> command:</p>
<pre><code>$ ./kploy stats
Runtime stats for app `myns/simple_app`:

[Your app's pods]

NAME                HOST             STATUS    URL
webserver-rc-29pxj  167.114.218.157  Running   http://ma.dcos.ca1.mesosphere.com/service/kubernetes/api/v1/namespaces/default/pods/webserver-rc-29pxj

================================================================================
[Nodes used by your app]

IP               HOST OS                CONTAINER RUNTIME    CAPACITY (PODS, CPU, MEM)    URL
167.114.218.157  CentOS Linux 7 (Core)  docker://1.8.2       40, 40, 256708Mi             http://ma.dcos.ca1.mesosphere.com/service/kubernetes/api/v1/nodes/167.114.218.157

================================================================================
</code></pre>
      <h3 id="scale">Scale</h3>
      <p>To scale one of the RCs of your app, use the <code>scale</code> command as described in
      the <a href="https://github.com/kubernauts/kploy/blob/master/dev.md#scale">Scale</a> section of the dev & ops doc.
      </p>
      <h3 id="debug">Debugging</h3>
      <p>Should you need to do some troubleshooting on the Pod-level, use the <code>debug</code> command as described in
      the <a href="https://github.com/kubernauts/kploy/blob/master/dev.md#debugging">Debugging</a> section of the dev & ops doc.
      </p>
      </section>
      <section>
        <h2 id="destroy">Tear down your app</h2>
        <p>To tear down your app, use the <code>destroy</code> command, for example:</p>
<pre><code>$ ./kploy destroy
2015-12-14T10:23:42 Deleted resource /api/v1/namespaces/default/services/webserver-svc
2015-12-14T10:23:42 Deleted resource /api/v1/namespaces/default/replicationcontrollers/webserver-rc
================================================================================

OK, I've destroyed `myns/simple_app`
</code></pre>
      </section>
      <section>
        <h2 id="export">Export your app</h2>
        <p>To share your app, you can make a snapshot of your app using the <code>export</code> command. This creates an archive called
        <code>app.kploy</code> that you can use in turn with the <code>init</code> command to create the app in a different location.</p>
<pre><code>$ ./kploy export -v
2015-12-22T01:47:18 Exporting app based on content from /Users/mhausenblas/Documents/repos/kubernauts/kploy
Adding content of app `myns/simple_app` to app.kploy
</code></pre>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/mhausenblas">mhausenblas</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
  </body>
</html>
